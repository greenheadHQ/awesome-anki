<div id="back" class="linkRender"><pre>{{cloze:Text}}</pre></div>
<br />
<hr />
<div id="extra" class="linkRender"><pre>{{Back Extra}}</pre></div>


<script>
  var getResources = [
    getCSS(
      "_katex.css",
      "https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    ),
    getCSS(
      "_highlights.css",
      "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/tokyo-night-dark.min.css"
    ),
    getScript(
      "_highlight.js",
      "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js"
    ),
    getScript(
      "_katex.min.js",
      "https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
    ),
    getScript(
      "_auto-render.js",
      "https://cdn.jsdelivr.net/gh/Jwrede/Anki-KaTeX-Markdown/auto-render-cdn.js"
    ),
    getScript(
      "_markdown-it.min.js",
      "https://cdnjs.cloudflare.com/ajax/libs/markdown-it/12.0.4/markdown-it.min.js"
    ),
    getScript(
      "_markdown-it-mark.js",
      "https://cdn.jsdelivr.net/gh/Jwrede/Anki-KaTeX-Markdown/_markdown-it-mark.js"
    ),
    getScript(
      "_markdown-it-container.min.js",
      "https://cdn.jsdelivr.net/npm/markdown-it-container@3.0.0/dist/markdown-it-container.min.js"
    ),
  ];

  Promise.all(getResources)
    .then(() =>
      getScript(
        "_mhchem.js",
        "https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/mhchem.min.js"
      )
    )
    .then(render)
    .catch(show);

  function getScript(path, altURL) {
    return new Promise((resolve, reject) => {
      let script = document.createElement("script");
      script.onload = resolve;
      script.onerror = function () {
        let script_online = document.createElement("script");
        script_online.onload = resolve;
        script_online.onerror = reject;
        script_online.src = altURL;

        document.querySelector(`script[src="${path}"]`)?.remove();
        document.head.appendChild(script_online);
      };
      script.src = path;

      document.querySelector(`script[src="${path}"]`)?.remove();
      document.head.appendChild(script);
    });
  }

  function getCSS(path, altURL) {
    return new Promise((resolve, reject) => {
      const css = document.createElement("link");
      css.setAttribute("rel", "stylesheet");
      css.type = "text/css";
      css.onload = resolve;
      css.onerror = function () {
        const css_online = document.createElement("link");
        css_online.setAttribute("rel", "stylesheet");
        css_online.type = "text/css";
        css_online.onload = resolve;
        css_online.onerror = reject;
        css_online.href = altURL;

        document.querySelector(`link[href="${path}"]`)?.remove();
        document.head.appendChild(css_online);
      };
      css.href = path;

      document.querySelector(`link[href="${path}"]`)?.remove();
      document.head.appendChild(css);
    });
  }

  function getMarkdownRenderer() {
    const md = new markdownit({
      typographer: true,
      html: true,
      highlight: function (str, lang) {
        if (lang && hljs.getLanguage(lang)) {
          try {
            return hljs.highlight(str, { language: lang }).value;
          } catch (__) {}
        }
        return "";
      },
    }).use(markdownItMark);

    const calloutTypes = ['tip', 'warning', 'error', 'note', 'link'];

    const getCalloutImoji = type => {
      switch (type) {
        case 'tip':
          return 'ğŸ’¡';
        case 'warning':
          return 'ğŸš§';
        case 'error':
          return 'ğŸš¨';
        case 'note':
          return 'ğŸ“';
        case 'link':
          return 'ğŸ”—';
        default:
          return '';
      }
    };

    calloutTypes.forEach(type => {
      md.use(window.markdownitContainer, type, {
        validate: function (params) {
          return params.trim().match(new RegExp(`^${type}(\\s+(.*))?$`));
        },
        render: function (tokens, idx) {
          const m = tokens[idx].info.trim().match(new RegExp(`^${type}(\\s+(.*))?$`));
          if (tokens[idx].nesting === 1) {
            const title = m && m[2] ? `<strong>${getCalloutImoji(type)} ${md.utils.escapeHtml(m[2])}</strong>` : '';
            return `<div class="callout ${type}">${title}`;
          } else {
            return '</div>\n';
          }
        }
      });
    });

    // Toggle ì»¨í…Œì´ë„ˆ ì¶”ê°€ (íƒ€ì…ë³„ ë°°ê²½ìƒ‰ ì§€ì›: tip, warning, error, note)
    md.use(window.markdownitContainer, 'toggle', {
      validate: function (params) {
        return params.trim().match(/^toggle(\s+(.*))?$/);
      },
      render: function (tokens, idx) {
        const m = tokens[idx].info.trim().match(/^toggle(\s+(.*))?$/);
        if (tokens[idx].nesting === 1) {
          // íƒ€ì…ê³¼ ì œëª© ë¶„ë¦¬
          const restText = m && m[2] ? m[2].trim() : '';
          const toggleTypes = ['tip', 'warning', 'error', 'note', 'todo'];
          let toggleType = '';
          let title = 'ì •ë³´';

          if (restText) {
            const firstWord = restText.split(/\s+/)[0];
            if (toggleTypes.includes(firstWord)) {
              // ì²« ë‹¨ì–´ê°€ íƒ€ì…ì¸ ê²½ìš°
              toggleType = firstWord;
              title = restText.substring(firstWord.length).trim() || 'ì •ë³´';
            } else {
              // íƒ€ì…ì´ ì—†ëŠ” ê²½ìš°, ì „ì²´ê°€ ì œëª©
              title = restText;
            }
          }

          const typeClass = toggleType ? ` ${toggleType}` : '';
          title = md.renderInline(title);

          return `<div class="toggle${typeClass}">
            <div class="toggle-header">
              <span class="toggle-arrow"></span>
              <span class="toggle-title">${title}</span>
            </div>
            <div class="toggle-content">`;
        } else {
          return '</div></div>\n';
        }
      }
    });

    return md;
  }


  function render() {
    // ğŸ¯ STEP 1: AnkiNoteLinker íŒŒì‹±ì„ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì „ì— ì‹¤í–‰
    if (!window.AnkiNoteLinkerIsActive) {
      renderLinksBeforeEscape();
    }

    renderMath("back");
    markdown("back");
    renderMath("extra");
    markdown("extra");
    initializeToggles();
    show();

    // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
    // render ë©”ì„œë“œ ë‚´ë¶€ì— ì•„ë˜ ì½”ë“œ ì •ì˜
    var clozeCards = document.getElementsByClassName("cloze");
    for (var i = 0; i < clozeCards.length; i++) {
      clozeCards[i].style.boxShadow = "inset 0 -2.3px 0 #85B0FD";
    }

    var inactiveClozeCards =
      document.getElementsByClassName("cloze-inactive");
    for (let inactiveClozeCard of inactiveClozeCards) {
      inactiveClozeCard.style.boxShadow = "inset 0 -2.3px 0 #FA96AF";
    }
    // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
  }

  /*
   * ğŸ¯ Toggle ì´ˆê¸°í™” í•¨ìˆ˜
   *
   * ëª©ì : ëª¨ë“  Toggle í—¤ë”ì— í´ë¦­/í„°ì¹˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
   * ë™ì‘: í´ë¦­ ë˜ëŠ” í„°ì¹˜ ì‹œ toggle-active í´ë˜ìŠ¤ í† ê¸€í•˜ì—¬ í¼ì¹¨/ì ‘í˜ ìƒíƒœ ë³€ê²½
   *
   * ëª¨ë°”ì¼ í™˜ê²½(iOS/iPadOS) ì§€ì›:
   * - touchend ì´ë²¤íŠ¸ë¡œ í„°ì¹˜ ë””ë°”ì´ìŠ¤ì—ì„œ ì •ìƒ ì‘ë™
   * - preventDefault()ë¡œ ê¸°ë³¸ ë™ì‘ ë°©ì§€ ë° :hover ìƒíƒœ ì œê±°
   * - ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
   *
   * PC í™˜ê²½ ê°œì„ :
   * - í´ë¦­ í›„ blur()ë¡œ focus ì œê±°í•˜ì—¬ hover ìƒíƒœ ìœ ì§€ ë°©ì§€
   */
  function initializeToggles() {
    const toggleHeaders = document.querySelectorAll(".toggle-header");

    toggleHeaders.forEach((header) => {
      let lastToggleTime = 0;

      const toggleHandler = function(e) {
        // í„°ì¹˜ ì´ë²¤íŠ¸ì—ì„œ ê¸°ë³¸ ë™ì‘ ë°©ì§€ (iOS :hover ë¬¸ì œ í•´ê²°)
        if (e.type === 'touchend') {
          e.preventDefault();
        }

        // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€: 300ms ì´ë‚´ì˜ ì—°ì† ì´ë²¤íŠ¸ëŠ” ë¬´ì‹œ
        const now = Date.now();
        if (now - lastToggleTime < 300) {
          return;
        }
        lastToggleTime = now;

        const toggleContainer = this.parentElement;
        toggleContainer.classList.toggle("toggle-active");

        // PCì—ì„œ í´ë¦­ í›„ focus ì œê±°í•˜ì—¬ hover ìƒíƒœ ìœ ì§€ ë°©ì§€
        this.blur();
      };

      // PC í™˜ê²½: click ì´ë²¤íŠ¸
      header.addEventListener("click", toggleHandler);

      // ëª¨ë°”ì¼ í™˜ê²½(iOS/iPadOS): touchend ì´ë²¤íŠ¸
      // passive: falseë¥¼ ì§€ì •í•˜ì—¬ preventDefault()ê°€ ë™ì‘í•˜ë„ë¡ í•¨
      header.addEventListener("touchend", toggleHandler, { passive: false });
    });
  }

  /*
   * ğŸ¯ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì „ì— AnkiNoteLinker íŒŒì‹±ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
   * 
   * ëª©ì : ì½”ë“œ ë¸”ë¡ ë‚´ì—ì„œë„ AnkiNoteLinkerê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë„ë¡ í•¨
   * 
   * ì¤‘ìš”: ì´ í•¨ìˆ˜ëŠ” markdown() í•¨ìˆ˜ê°€ HTMLì„ ì´ìŠ¤ì¼€ì´í”„í•˜ê¸° ì „ì— ì‹¤í–‰ë˜ì–´ì•¼ í•¨
   */
  function renderLinksBeforeEscape() {
    console.log("===== BACK - AnkiNoteLinker ì‚¬ì „ íŒŒì‹± ì‹œì‘ =====");
    
    document.querySelectorAll('.linkRender').forEach(element => {
      console.log("BACK - ë§í¬ íŒŒì‹± ëŒ€ìƒ ìš”ì†Œ:", element.id);
      
      const originalContent = element.innerHTML;
      console.log("BACK - ì›ë³¸ ë‚´ìš©:", originalContent);
      
      const processedContent = originalContent.replace(
        /\[((?:[^\[]|\\\[)*)\|nid(\d{13})\]/g,
        (match, title, nid) => {
          console.log(`BACK - AnkiNoteLinker íŒ¨í„´ ë°œê²¬: ${match}`);
          
          title = title.replace(/\\\[/g, '[');
          let link;
          
          if (document.documentElement.classList.contains('iphone') || 
              document.documentElement.classList.contains('ipad')) {
            link = `anki://x-callback-url/search?query=nid%3a${nid}`;
          } else {
            try {
              window.jsAPI ||= new AnkiDroidJS({ version: "0.0.3", developer: "github.com/gugutu" });
              link = `javascript:window.jsAPI.ankiSearchCard(\`nid:${nid}\`)`;
            } catch (e) {
              link = `https://ankiuser.net/edit/${nid}' target='_blank`;
            }
          }
          
          const result = disableLinks ? `${title}` : `<a href='${link}' class='noteLink'>${title}</a>`;
          console.log(`BACK - ë³€í™˜ ê²°ê³¼: ${match} â†’ ${result}`);
          
          return result;
        }
      );
      
      if (processedContent !== originalContent) {
        element.innerHTML = processedContent;
        console.log("BACK - AnkiNoteLinker íŒŒì‹± ì™„ë£Œ");
      } else {
        console.log("BACK - íŒŒì‹±í•  ë§í¬ ì—†ìŒ");
      }
    });
    
    console.log("===== BACK - AnkiNoteLinker ì‚¬ì „ íŒŒì‹± ì™„ë£Œ =====");
  }

  function show() {
    document.getElementById("back").style.visibility = "visible";
    document.getElementById("extra").style.visibility = "visible";
  }

  function renderMath(ID) {
    let text = document.getElementById(ID).innerHTML;
    text = replaceInString(text);
    document.getElementById(ID).textContent = text;
    renderMathInElement(document.getElementById(ID), {
      delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "$", right: "$", display: false},
      ],
      throwOnError: false,
    });
  }

  function markdown(ID) {
    /*
     * ğŸ¯ ANKI CLOZE + MARKDOWN + ì½”ë“œ ë¸”ë¡ ì²˜ë¦¬ í”Œë¡œìš° ìƒì„¸ ì„¤ëª… (BACK ì¹´ë“œ)
     *
     * === ğŸ“‹ ì „ì²´ ê°œìš” ===
     * ì´ BACK ì¹´ë“œ í…œí”Œë¦¿ì€ front.htmlê³¼ ë™ì¼í•œ ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ ë¡œì§ì„ ì‚¬ìš©í•˜ë˜,
     * ëª¨ë“  clozeê°€ ì´ë¯¸ í¼ì³ì§„ ìƒíƒœë¡œ í‘œì‹œë˜ë¯€ë¡œ í´ë¦­/í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬ëŠ” ì—†ìŠµë‹ˆë‹¤.
     *
     * === ğŸ”„ ì£¼ìš” ì²˜ë¦¬ í”Œë¡œìš° ===
     *
     * 1ï¸âƒ£ ì´ˆê¸°í™” (render í•¨ìˆ˜)
     *    â”œâ”€ renderMath("back") : KaTeX ìˆ˜í•™ ê³µì‹ ë Œë”ë§ (back ì˜ì—­)
     *    â”œâ”€ markdown("back") : ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ (í•µì‹¬ ë¡œì§)
     *    â”œâ”€ renderMath("extra") : KaTeX ìˆ˜í•™ ê³µì‹ ë Œë”ë§ (extra ì˜ì—­)
     *    â”œâ”€ markdown("extra") : ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ (extra ì˜ì—­)
     *    â”œâ”€ show() : ì¹´ë“œ í‘œì‹œ
     *    â””â”€ cloze ìŠ¤íƒ€ì¼ë§ : ì´ë¯¸ í¼ì³ì§„ clozeì˜ ì‹œê°ì  ìŠ¤íƒ€ì¼ ì ìš©
     *
     * 2ï¸âƒ£ ë§ˆí¬ë‹¤ìš´ ì²˜ë¦¬ (markdown í•¨ìˆ˜) â˜… front.htmlê³¼ ë™ì¼ â˜…
     *    â”œâ”€ STEP 1: ì½”ë“œ ë¸”ë¡ ë‚´ cloze span ì„ì‹œ ì €ì¥
     *    â”‚   â”œâ”€ ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒ¨í„´ íƒì§€ : /(```[a-zA-Z0-9_\-]+[\s\S]*?```)/g
     *    â”‚   â”œâ”€ ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì˜ <span class="cloze">...</span> ì¶”ì¶œ
     *    â”‚   â””â”€ í”Œë ˆì´ìŠ¤í™€ë”(__CLOZE_SPAN_X__)ë¡œ ì„ì‹œ êµì²´
     *    â”‚
     *    â”œâ”€ STEP 2: ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ìˆ˜í–‰
     *    â”‚   â””â”€ markdown-it ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë§ˆí¬ë‹¤ìš´ â†’ HTML ë³€í™˜
     *    â”‚
     *    â”œâ”€ STEP 3: ì¼ë°˜ span íƒœê·¸ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
     *    â”‚   â””â”€ &lt;/span&gt; â†’ \ êµì²´
     *    â”‚
     *    â”œâ”€ STEP 4: ì €ì¥ëœ cloze span ë³µì›
     *    â”‚   â””â”€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì›ë˜ cloze spanìœ¼ë¡œ êµì²´ (ì´ìŠ¤ì¼€ì´í”„ ì—†ì´)
     *    â”‚
     *    â”œâ”€ STEP 5: DOMì— ì„¤ì •
     *    â”‚   â””â”€ element.innerHTML = finalText
     *    â”‚
     *    â””â”€ STEP 6: ì½”ë“œ ë¸”ë¡ ë‚´ HTML ì´ìŠ¤ì¼€ì´í”„
     *        â””â”€ escapeHtmlInCodeBlocks() í˜¸ì¶œ
     *
     * 3ï¸âƒ£ ì½”ë“œ ë¸”ë¡ HTML ì´ìŠ¤ì¼€ì´í”„ (escapeHtmlInCodeBlocks í•¨ìˆ˜)
     *    â”œâ”€ code[class*="language-"] ìš”ì†Œë“¤ íƒìƒ‰
     *    â”œâ”€ ê° ì½”ë“œ ë¸”ë¡ ë‚´ì˜ span.cloze ìš”ì†Œë“¤ ì°¾ê¸°
     *    â”œâ”€ ì´ë¯¸ ì´ìŠ¤ì¼€ì´í”„ëœ ë‚´ìš©ì¸ì§€ í™•ì¸ (&lt;, &gt; í¬í•¨ ì—¬ë¶€)
     *    â””â”€ span.textContent = originalHtml (ë¸Œë¼ìš°ì € ìë™ ì´ìŠ¤ì¼€ì´í”„)
     *
     * === ğŸ¯ BACK ì¹´ë“œ íŠ¹ì§• ===
     *
     * âœ… ëª¨ë“  clozeê°€ í¼ì³ì§„ ìƒíƒœ: Ankiì—ì„œ ìë™ìœ¼ë¡œ ëª¨ë“  cloze ë‚´ìš©ì´ í‘œì‹œë¨
     * âœ… ì½”ë“œ ë¸”ë¡ ë‚´ HTML ì´ìŠ¤ì¼€ì´í”„: frontì™€ ë™ì¼í•˜ê²Œ HTML íƒœê·¸ê°€ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë¨
     * âœ… ë§ˆí¬ë‹¤ìš´ íŒŒì‹±: ì¼ë°˜ ì˜ì—­ì˜ ë§ˆí¬ë‹¤ìš´ì€ ì •ìƒì ìœ¼ë¡œ ë Œë”ë§ë¨
     * âŒ ìƒí˜¸ì‘ìš© ì—†ìŒ: í´ë¦­/í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¶ˆí•„ìš”
     *
     * === ğŸ” ì²˜ë¦¬ ì˜ˆì‹œ ===
     *
     * ğŸ“ ì¼ë°˜ ì˜ì—­ cloze:
     *    ì…ë ¥: **bold text** in cloze
     *    ì¶œë ¥: <b>bold text</b> in cloze (ë§ˆí¬ë‹¤ìš´ íŒŒì‹±ë¨)
     *
     * ğŸ’» ì½”ë“œ ë¸”ë¡ ë‚´ cloze:
     *    ì…ë ¥: <li>list item</li>
     *    ì¶œë ¥: &lt;li&gt;list item&lt;/li&gt; (HTML íƒœê·¸ê°€ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ)
     *
     * === ğŸ“š ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ ===
     * - KaTeX: ìˆ˜í•™ ê³µì‹ ë Œë”ë§
     * - highlight.js: ì½”ë“œ êµ¬ë¬¸ ê°•ì¡°  
     * - markdown-it: ë§ˆí¬ë‹¤ìš´ íŒŒì‹±
     * - markdown-it-mark: ==í…ìŠ¤íŠ¸== ë§ˆí¬ ì§€ì›
     * - markdown-it-container: ì»¤ìŠ¤í…€ ì»¨í…Œì´ë„ˆ ì§€ì› (tip, warning ë“±)
     */
    const md = getMarkdownRenderer();
    const element = document.getElementById(ID);
    let text = replaceHTMLElementsInString(element.innerHTML);
    console.log("BACK - ì´ˆê¸° í…ìŠ¤íŠ¸:", text);
    
    /*
     * ğŸ¯ STEP 0: ë§ˆí¬ë‹¤ìš´ íŒŒì‹± ì´ì „ ë°±í‹± ë³´í˜¸ â˜… front.htmlê³¼ ë™ì¼ â˜…
     * 
     * ë°±í‹±ì„ ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³€í™˜í•˜ì—¬ markdown-itì´ ê±´ë“œë¦¬ì§€ ëª»í•˜ê²Œ í•¨
     */
    text = protectBackticks(text);
    console.log("BACK - ë°±í‹± ë³´í˜¸ ì™„ë£Œ:", text);
    
    /*
     * ğŸ¯ STEP 1: ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ë‚´ cloze span ì„ì‹œ ì €ì¥
     * 
     * ë¬¸ì œ: ë§ˆí¬ë‹¤ìš´ íŒŒì„œê°€ ì½”ë“œ ë¸”ë¡(```js ... ```) ë‚´ë¶€ì˜ HTMLì„ ì²˜ë¦¬í•  ë•Œ 
     *       cloze span íƒœê·¸ê°€ ê¹¨ì§ˆ ìˆ˜ ìˆìŒ
     * 
     * í•´ê²°: ë§ˆí¬ë‹¤ìš´ íŒŒì‹± ì „ì— ì½”ë“œ ë¸”ë¡ ë‚´ì˜ cloze spanì„ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµì²´í•˜ì—¬ ë³´í˜¸
     *       ë§ˆí¬ë‹¤ìš´ íŒŒì‹± í›„ ë‹¤ì‹œ ë³µì›
     */
    const clozeSpans = [];  // ì„ì‹œ ì €ì¥í•  cloze span ë°°ì—´
    let codeBlockCount = 0; // ì½”ë“œ ë¸”ë¡ ê°œìˆ˜ ì¹´ìš´í„° (ë””ë²„ê¹…ìš©)
    
    // ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒ¨í„´ ë§¤ì¹­: ```[ì–¸ì–´ëª…] ... ```
    // [a-zA-Z0-9_\-]+ : ì–¸ì–´ëª… (js, python, html ë“±)
    text = text.replace(/(```[a-zA-Z0-9_\-]+[\s\S]*?```)/g, function(codeBlock) {
      codeBlockCount++;
      
      // í•´ë‹¹ ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì˜ cloze spanì„ ì°¾ì•„ì„œ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµì²´
      return codeBlock.replace(/<span\s+class\s*=\s*["']cloze["'].*?<\/span>/gi, function(match) {
        const placeholder = `__CLOZE_SPAN_${clozeSpans.length}__`;
        clozeSpans.push(match);  // ì›ë³¸ span ì €ì¥
        return placeholder;  // í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµì²´
      });
    });
    
    /*
     * ğŸ¯ STEP 2: ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ìˆ˜í–‰
     * 
     * ì´ì œ ì½”ë“œ ë¸”ë¡ ë‚´ì˜ cloze spanì´ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ ë³´í˜¸ë˜ì—ˆìœ¼ë¯€ë¡œ
     * ì•ˆì „í•˜ê²Œ ë§ˆí¬ë‹¤ìš´ íŒŒì‹±ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ
     */
    text = md.render(text);
    
    /*
     * ğŸ¯ STEP 3: ì¼ë°˜ span íƒœê·¸ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
     * 
     * ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ê³¼ì •ì—ì„œ ì¼ë¶€ span íƒœê·¸ê°€ &lt;/span&gt; í˜•íƒœë¡œ 
     * ì´ìŠ¤ì¼€ì´í”„ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ë°±ìŠ¬ë˜ì‹œë¡œ êµì²´
     */
    text = text.replace(/&lt;\/span&gt;/gi, "\\");
    
    /*
     * ğŸ¯ STEP 4: ì €ì¥ëœ cloze span ë³µì›
     * 
     * í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì›ë˜ì˜ cloze spanìœ¼ë¡œ ë‹¤ì‹œ êµì²´
     * ì´ë•Œ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì—†ì´ ê·¸ëŒ€ë¡œ ë³µì›í•˜ì—¬ 
     * Ankiê°€ cloze ê¸°ëŠ¥ì„ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•¨
     */
    let finalText = text;
    clozeSpans.forEach((span, index) => {
      const placeholder = `__CLOZE_SPAN_${index}__`;
      
      // í”Œë ˆì´ìŠ¤í™€ë”ê°€ í…ìŠ¤íŠ¸ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ í›„ ë³µì›
      const placeholderPattern = new RegExp(placeholder, 'g');
      if(finalText.match(placeholderPattern)) {
        finalText = finalText.replace(placeholderPattern, span);
      }
    });
    
    /*
     * ğŸ¯ STEP 5: DOMì— ì„¤ì •
     * 
     * ìµœì¢… ì²˜ë¦¬ëœ HTMLì„ DOM ìš”ì†Œì— ì ìš©
     */
    element.innerHTML = finalText;
    
    /*
     * ğŸ¯ STEP 5.5: ë³´í˜¸ëœ ë°±í‹± ì½”ë“œë¥¼ <code> íƒœê·¸ë¡œ ë³€í™˜ â˜… front.htmlê³¼ ë™ì¼ â˜…
     * 
     * ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³´í˜¸ëœ ë°±í‹±ì„ ì°¾ì•„ì„œ <code> íƒœê·¸ë¡œ ë³€í™˜
     */
    processProtectedBackticks(element);
    
    /*
     * ğŸ¯ STEP 6: ì´ˆê¸° ë°±í‹± â†’ ì½”ë“œ íƒœê·¸ ë³€í™˜ (ëª¨ë“  clozeì— ì ìš©)
     * 
     * front.htmlê³¼ ë™ì¼í•œ ì²˜ë¦¬ - í…Œì´ë¸” ë‚´ë¶€ ë“±ì—ì„œ ë°±í‹±ì´ ì½”ë“œ íƒœê·¸ë¡œ ë³€í™˜ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ í•´ê²°
     */
    convertBackticksToCodeTags(element);
    
    /*
     * ğŸ¯ STEP 7: ë‹¨ìˆœí•œ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
     * 
     * front.htmlê³¼ ë™ì¼í•œ ì²˜ë¦¬ - íŠ¹ì • HTML íƒœê·¸ë§Œ ì„ ë³„ì ìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„
     */
    escapeSpecificHtmlTags(element);
    
    /*
     * ğŸ¯ STEP 8: ì½”ë“œ ë¸”ë¡ ë‚´ cloze spanì˜ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
     * 
     * DOMì´ ìƒì„±ëœ í›„, ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì˜ cloze spanì— í¬í•¨ëœ 
     * HTML íƒœê·¸ë“¤ì„ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë˜ë„ë¡ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
     * 
     * ì˜ˆ: <li></li> â†’ &lt;li&gt;&lt;/li&gt;
     */
    escapeHtmlInCodeBlocks(element);
  }

  /*
   * ğŸ¯ ë§ˆí¬ë‹¤ìš´ íŒŒì‹± ì´ì „ ë°±í‹± ë³´í˜¸ í•¨ìˆ˜ (BACK ì¹´ë“œìš© - ê°œì„ ëœ ì ‘ê·¼ë²•)
   * 
   * ëª©ì : ë°±í‹±ì„ ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³€í™˜í•˜ë˜, HTML ì†ì„± ë‚´ë¶€ëŠ” ë³´í˜¸
   * ì¤‘ìš”: ì½”ë“œ ë¸”ë¡(```...```) ë‚´ë¶€ëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ
   * front.htmlê³¼ ë™ì¼í•œ ë¡œì§ ì ìš©
   */
  function protectBackticks(text) {
    console.log("===== BACK - ë°±í‹± ë³´í˜¸ ì‹œì‘ =====");
    console.log("BACK - ì›ë³¸ í…ìŠ¤íŠ¸:", text);
    
    // 1ë‹¨ê³„: ì½”ë“œ ë¸”ë¡ ì˜ì—­ì„ ë¨¼ì € ì°¾ì•„ì„œ ë³´í˜¸
    const codeBlocks = [];
    let codeBlockIndex = 0;
    
    // ì½”ë“œ ë¸”ë¡ íŒ¨í„´ì„ ì„ì‹œ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµì²´
    let textWithProtectedCodeBlocks = text.replace(/(```[\s\S]*?```)/g, function(match) {
      const placeholder = `__CODE_BLOCK_${codeBlockIndex}__`;
      codeBlocks.push(match);
      console.log(`ğŸ”’ BACK - ì½”ë“œ ë¸”ë¡ #${codeBlockIndex} ë³´í˜¸:`, match.substring(0, 50) + "...");
      codeBlockIndex++;
      return placeholder;
    });
    
    console.log(`BACK - ì´ ${codeBlocks.length}ê°œì˜ ì½”ë“œ ë¸”ë¡ ë³´í˜¸ë¨`);
    
    // 2ë‹¨ê³„: HTML íƒœê·¸ ì „ì²´ë¥¼ ë³´í˜¸
    const htmlTags = [];
    let htmlTagIndex = 0;
    
    // HTML íƒœê·¸ íŒ¨í„´ì„ ì„ì‹œ í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµì²´ (ì†ì„± í¬í•¨)
    let textWithProtectedTags = textWithProtectedCodeBlocks.replace(/<[^>]+>/g, function(match) {
      const placeholder = `__HTML_TAG_${htmlTagIndex}__`;
      htmlTags.push(match);
      console.log(`ğŸ”’ BACK - HTML íƒœê·¸ #${htmlTagIndex} ë³´í˜¸:`, match);
      htmlTagIndex++;
      return placeholder;
    });
    
    console.log(`BACK - ì´ ${htmlTags.length}ê°œì˜ HTML íƒœê·¸ ë³´í˜¸ë¨`);
    
    // 3ë‹¨ê³„: ë‚¨ì€ ë°±í‹±ì„ ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³€í™˜
    let processedText = textWithProtectedTags.replace(/`([^`]+)`/g, function(match, code) {
      console.log(`ğŸ” BACK - ë°±í‹± ì½”ë“œ ë°œê²¬: ${match}`);
      // ë°±í‹±ì„ íŠ¹ìˆ˜ ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ì¹˜í™˜
      return `â€¹${code}â€º`;
    });
    
    // 4ë‹¨ê³„: HTML íƒœê·¸ ë³µì›
    htmlTags.forEach((htmlTag, index) => {
      const placeholder = `__HTML_TAG_${index}__`;
      processedText = processedText.replace(placeholder, htmlTag);
      console.log(`ğŸ”“ BACK - HTML íƒœê·¸ #${index} ë³µì› ì™„ë£Œ`);
    });
    
    // 5ë‹¨ê³„: ì½”ë“œ ë¸”ë¡ ë³µì›
    codeBlocks.forEach((codeBlock, index) => {
      const placeholder = `__CODE_BLOCK_${index}__`;
      processedText = processedText.replace(placeholder, codeBlock);
      console.log(`ğŸ”“ BACK - ì½”ë“œ ë¸”ë¡ #${index} ë³µì› ì™„ë£Œ`);
    });
    
    console.log("BACK - ë°±í‹± ë³´í˜¸ í›„:", processedText);
    console.log("===== BACK - ë°±í‹± ë³´í˜¸ ì¢…ë£Œ =====");
    return processedText;
  }

  /*
   * ğŸ¯ ë³´í˜¸ëœ ë°±í‹± ì½”ë“œë¥¼ <code> íƒœê·¸ë¡œ ë³€í™˜ (BACK ì¹´ë“œìš©)
   * 
   * ëª©ì : ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³´í˜¸ëœ ë°±í‹±ì„ ì°¾ì•„ì„œ <code> íƒœê·¸ë¡œ ë³€í™˜
   * front.htmlê³¼ ë™ì¼í•œ ë¡œì§
   */
  function processProtectedBackticks(container) {
    console.log("===== BACK - ë³´í˜¸ëœ ë°±í‹± ì²˜ë¦¬ ì‹œì‘ =====");
    
    // í˜„ì¬ HTML í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
    let htmlContent = container.innerHTML;
    console.log("BACK - ì²˜ë¦¬ ì „ HTML:", htmlContent);
    
    // ìœ ë‹ˆì½”ë“œ ë¬¸ìë¡œ ë³´í˜¸ëœ ë°±í‹±ì„ <code> íƒœê·¸ë¡œ ë³€í™˜
    let processedCount = 0;
    htmlContent = htmlContent.replace(/â€¹([^â€º]+)â€º/g, function(match, code) {
      console.log(`ğŸ” BACK - ë³´í˜¸ëœ ë°±í‹± ë°œê²¬: ${match}`);
      
      // HTML íƒœê·¸ ì´ìŠ¤ì¼€ì´í”„
      const escapedCode = code.replace(/</g, '&lt;').replace(/>/g, '&gt;');
      const codeTag = `<code>${escapedCode}</code>`;
      
      console.log(`  ë³€í™˜: ${match} â†’ ${codeTag}`);
      processedCount++;
      
      return codeTag;
    });
    
    // ìˆ˜ì •ëœ HTMLì„ ë‹¤ì‹œ ì„¤ì •
    container.innerHTML = htmlContent;
    console.log(`BACK - ì²˜ë¦¬ ì™„ë£Œ: ${processedCount}ê°œì˜ ë°±í‹± ì½”ë“œ ë³€í™˜`);
    console.log("BACK - ì²˜ë¦¬ í›„ HTML:", htmlContent);
    
    console.log("===== BACK - ë³´í˜¸ëœ ë°±í‹± ì²˜ë¦¬ ì¢…ë£Œ =====");
  }

  /*
   * ğŸ”§ ë‹¨ìˆœí•œ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ í•¨ìˆ˜ (BACK ì¹´ë“œìš© - AnkiNoteLinker ë³´í˜¸ ê°œì„ )
   * 
   * ëª©ì : cloze ë‚´ë¶€ì˜ íŠ¹ì • HTML íƒœê·¸ë§Œ ì„ ë³„ì ìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
   * ì¤‘ìš”: ë§í¬(a íƒœê·¸)ì™€ AnkiNoteLinkerëŠ” ë³´í˜¸
   * front.htmlê³¼ ë™ì¼í•œ ë¡œì§ ì ìš©
   */
  function escapeSpecificHtmlTags(container) {
    console.log("===== BACK - AnkiNoteLinker ë³´í˜¸ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì‹œì‘ =====");
    
    // ì´ìŠ¤ì¼€ì´í”„í•  HTML íƒœê·¸ ëª©ë¡ (êµ¬ì¡°ì ì¸ íƒœê·¸ë“¤ë§Œ, ë§ˆí¬ë‹¤ìš´ í—ˆìš© íƒœê·¸ì™€ ë§í¬ëŠ” ì œì™¸)
    // í—ˆìš©ë˜ëŠ” ë§ˆí¬ë‹¤ìš´ HTML íƒœê·¸: code, sup, sub, u, strong, em, b, i, mark, a (ë§í¬ ì¶”ê°€)
    const tagsToEscape = ['form', 'input', 'button', 'div', 'span', 'tr', 'td', 'th', 
                          'ul', 'ol', 'li', 'select', 'option', 'textarea'];
    
    // ëª¨ë“  cloze span ì°¾ê¸°
    const allClozeSpans = container.querySelectorAll('span.cloze');
    console.log(`BACK - ì´ ${allClozeSpans.length}ê°œì˜ cloze span ë°œê²¬`);
    
    allClozeSpans.forEach((span, index) => {
      console.log(`\n--- BACK - cloze span #${index + 1} ì²˜ë¦¬ ---`);
      
      // í˜„ì¬ spanì´ ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì— ìˆëŠ”ì§€ í™•ì¸
      let isInCodeBlock = false;
      let parent = span.parentElement;
      
      while (parent) {
        if (parent.nodeName === "CODE") {
          isInCodeBlock = true;
          break;
        }
        parent = parent.parentElement;
      }
      
      const originalHtml = span.innerHTML;
      console.log("BACK - ì›ë³¸ ë‚´ìš©:", originalHtml);
      console.log("BACK - ì½”ë“œ ë¸”ë¡ ë‚´ë¶€?", isInCodeBlock);
      
      // AnkiNoteLinkerê°€ ìˆëŠ”ì§€ í™•ì¸
      const hasAnkiNoteLinker = originalHtml.includes('class="noteLink"') || 
                                originalHtml.includes('AnkiNoteLinker');
      console.log("BACK - AnkiNoteLinker í¬í•¨?", hasAnkiNoteLinker);
      
      if (isInCodeBlock && !hasAnkiNoteLinker) {
        /*
         * ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì´ì§€ë§Œ AnkiNoteLinkerê°€ ì—†ëŠ” ê²½ìš°: ëª¨ë“  HTMLì„ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ
         */
        if (originalHtml && !originalHtml.includes('&lt;')) {
          span.textContent = originalHtml;
          console.log("BACK - ì½”ë“œ ë¸”ë¡ì—ì„œ ì „ì²´ ì´ìŠ¤ì¼€ì´í”„:", span.innerHTML);
        }
      } else if (isInCodeBlock && hasAnkiNoteLinker) {
        /*
         * ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì´ì§€ë§Œ AnkiNoteLinkerê°€ ìˆëŠ” ê²½ìš°: AnkiNoteLinkerë§Œ ë³´í˜¸í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì´ìŠ¤ì¼€ì´í”„
         */
        console.log("BACK - ì½”ë“œ ë¸”ë¡ ë‚´ AnkiNoteLinker ë³´í˜¸ ëª¨ë“œ");
        
        // AnkiNoteLinker ë§í¬ë¥¼ ì„ì‹œë¡œ ë³´í˜¸
        const protectedLinks = [];
        let protectedContent = originalHtml;
        
        // noteLink í´ë˜ìŠ¤ë¥¼ ê°€ì§„ <a> íƒœê·¸ë¥¼ ì°¾ì•„ì„œ ë³´í˜¸
        protectedContent = protectedContent.replace(/<a[^>]*class="noteLink"[^>]*>.*?<\/a>/gi, function(match) {
          const placeholder = `__ANKI_NOTE_LINK_${protectedLinks.length}__`;
          protectedLinks.push(match);
          console.log(`BACK - AnkiNoteLinker ë³´í˜¸ #${protectedLinks.length}:`, match);
          return placeholder;
        });
        
        // ë‚˜ë¨¸ì§€ HTML íƒœê·¸ë“¤ì„ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
        if (protectedContent && !protectedContent.includes('&lt;')) {
          // textContentë¡œ ì„¤ì •í•˜ì—¬ HTML ì´ìŠ¤ì¼€ì´í”„
          const tempDiv = document.createElement('div');
          tempDiv.textContent = protectedContent;
          protectedContent = tempDiv.innerHTML;
        }
        
        // ë³´í˜¸ëœ AnkiNoteLinker ë³µì›
        protectedLinks.forEach((link, linkIndex) => {
          const placeholder = `__ANKI_NOTE_LINK_${linkIndex}__`;
          protectedContent = protectedContent.replace(placeholder, link);
          console.log(`BACK - AnkiNoteLinker ë³µì› #${linkIndex + 1}`);
        });
        
        span.innerHTML = protectedContent;
        console.log("BACK - ì½”ë“œ ë¸”ë¡ì—ì„œ AnkiNoteLinker ë³´í˜¸ ì²˜ë¦¬ ì™„ë£Œ:", protectedContent);
        
      } else {
        /*
         * ì¼ë°˜ ì˜ì—­: íŠ¹ì • HTML íƒœê·¸ë§Œ ì´ìŠ¤ì¼€ì´í”„ (ë§í¬ëŠ” ë³´í˜¸)
         */
        let content = originalHtml;
        let hasChanges = false;
        
        // ê° íƒœê·¸ì— ëŒ€í•´ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
        tagsToEscape.forEach(tag => {
          // <tag> í˜•íƒœì˜ ì—´ë¦° íƒœê·¸
          const openTagRegex = new RegExp(`<${tag}\\b[^>]*>`, 'gi');
          if (content.match(openTagRegex)) {
            content = content.replace(openTagRegex, function(match) {
              hasChanges = true;
              return match.replace(/</g, '&lt;').replace(/>/g, '&gt;');
            });
          }
          
          // </tag> í˜•íƒœì˜ ë‹«íŒ íƒœê·¸
          const closeTagRegex = new RegExp(`</${tag}>`, 'gi');
          if (content.match(closeTagRegex)) {
            content = content.replace(closeTagRegex, function(match) {
              hasChanges = true;
              return match.replace(/</g, '&lt;').replace(/>/g, '&gt;');
            });
          }
        });
        
        if (hasChanges) {
          span.innerHTML = content;
          console.log("BACK - ì¼ë°˜ ì˜ì—­ì—ì„œ ì„ ë³„ì  ì´ìŠ¤ì¼€ì´í”„:", content);
        } else {
          console.log("BACK - ì´ìŠ¤ì¼€ì´í”„í•  íƒœê·¸ ì—†ìŒ");
        }
      }
    });
    
    console.log("===== BACK - AnkiNoteLinker ë³´í˜¸ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì™„ë£Œ =====");
  }

  /*
   * ğŸ¨ ì´ˆê¸° ë°±í‹± â†’ ì½”ë“œ íƒœê·¸ ë³€í™˜ í•¨ìˆ˜ (BACK ì¹´ë“œìš© - ê°œì„ ëœ ë²„ì „)
   * 
   * ëª©ì : í˜ì´ì§€ ë¡œë”© ì‹œ ëª¨ë“  clozeì˜ ë°±í‹±ì„ <code> íƒœê·¸ë¡œ ë³€í™˜
   * ì¤‘ìš”: HTML ì†ì„± ë‚´ë¶€ì˜ ë°±í‹±ì€ ë³´í˜¸
   * front.htmlê³¼ ë™ì¼í•œ ë¡œì§ ì ìš©
   */
  function convertBackticksToCodeTags(container) {
    console.log("===== BACK - ì´ˆê¸° ë°±í‹± â†’ ì½”ë“œ íƒœê·¸ ë³€í™˜ ì‹œì‘ =====");
    
    // ëª¨ë“  cloze span ì°¾ê¸°
    const allClozeSpans = container.querySelectorAll('span.cloze');
    console.log(`BACK - ë°±í‹± ë³€í™˜ ëŒ€ìƒ: ${allClozeSpans.length}ê°œì˜ cloze span`);
    
    allClozeSpans.forEach((span, index) => {
      console.log(`\n--- BACK - cloze span #${index + 1} ë°±í‹± ì²˜ë¦¬ ---`);
      
      const originalHtml = span.innerHTML;
      console.log("BACK - ì›ë³¸ ë‚´ìš©:", originalHtml);
      
      /*
       * HTML ì†ì„± ë³´í˜¸ ì²˜ë¦¬
       */
      let result = originalHtml;
      
      // 1ë‹¨ê³„: HTML íƒœê·¸ì™€ ì†ì„±ì„ ë³´í˜¸
      const htmlElements = [];
      let htmlElementIndex = 0;
      
      result = result.replace(/<[^>]+>/g, function(match) {
        const placeholder = `__BACK_HTML_ELEMENT_${htmlElementIndex}__`;
        htmlElements.push(match);
        console.log(`BACK - HTML ìš”ì†Œ ë³´í˜¸ #${htmlElementIndex}:`, match);
        htmlElementIndex++;
        return placeholder;
      });
      
      // 2ë‹¨ê³„: ë³´í˜¸ëœ ìƒíƒœì—ì„œ ë°±í‹± ì²˜ë¦¬
      // íŒ¨í„´ 1: <`ë‚´ìš©`> í˜•íƒœ (Ankiê°€ ë°±í‹±ì„ íŒŒì‹±í•œ í›„)
      result = result.replace(/<`([^`]+)`>/g, function(match, code) {
        console.log("BACK - ì´ˆê¸° - íŒ¨í„´ 1 ë§¤ì¹­:", match, "â†’", code);
        const escapedCode = code.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return `<code>${escapedCode}</code>`;
      });
      
      // íŒ¨í„´ 2: ì¼ë°˜ì ì¸ ë°±í‹± `ë‚´ìš©` 
      result = result.replace(/`([^`]+)`/g, function(match, code) {
        console.log("BACK - ì´ˆê¸° - íŒ¨í„´ 2 ë§¤ì¹­:", match, "â†’", code);
        const escapedCode = code.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return `<code>${escapedCode}</code>`;
      });
      
      // 3ë‹¨ê³„: HTML ìš”ì†Œ ë³µì›
      htmlElements.forEach((htmlElement, elementIndex) => {
        const placeholder = `__BACK_HTML_ELEMENT_${elementIndex}__`;
        result = result.replace(placeholder, htmlElement);
        console.log(`BACK - HTML ìš”ì†Œ ë³µì› #${elementIndex}:`, htmlElement);
      });
      
      // 4ë‹¨ê³„: ë‚¨ì€ HTML íƒœê·¸ë“¤ ì´ìŠ¤ì¼€ì´í”„ (ë§í¬ì™€ ë§ˆí¬ë‹¤ìš´ í—ˆìš© íƒœê·¸ëŠ” ì œì™¸)
      // í—ˆìš©í•  ë§ˆí¬ë‹¤ìš´ HTML íƒœê·¸ë“¤: code, sup, sub, u, strong, em, b, i, mark, a (ë§í¬ ì¶”ê°€)
      result = result.replace(/<(?!\/?(code|sup|sub|u|strong|em|b|i|mark|a)\b)[^>]*>/g, function(match) {
        console.log("BACK - ì´ˆê¸° - íŒ¨í„´ 3 ë§¤ì¹­ (HTML ì´ìŠ¤ì¼€ì´í”„):", match);
        return match.replace(/</g, '&lt;').replace(/>/g, '&gt;');
      });
      
      if (result !== originalHtml) {
        span.innerHTML = result;
        console.log("BACK - ì´ˆê¸° ë°±í‹± ë³€í™˜ ì™„ë£Œ:", result);
      } else {
        console.log("BACK - ë³€í™˜í•  ë°±í‹± ì—†ìŒ");
      }
    });
    
    console.log("===== BACK - ì´ˆê¸° ë°±í‹± â†’ ì½”ë“œ íƒœê·¸ ë³€í™˜ ì™„ë£Œ =====");
  }

  /*
   * ğŸ”§ ì½”ë“œ ë¸”ë¡ ë‚´ cloze spanì˜ HTMLì„ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ (AnkiNoteLinker ë³´í˜¸)
   * 
   * ëª©ì : ì½”ë“œ ë¸”ë¡ ë‚´ì—ì„œ HTML íƒœê·¸ê°€ ì‹¤ì œ DOM ìš”ì†Œë¡œ ë Œë”ë§ë˜ì§€ ì•Šê³ 
   *       í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë˜ë„ë¡ í•¨ (ë‹¨, AnkiNoteLinkerëŠ” ë³´í˜¸)
   * 
   * ì²˜ë¦¬ ë²”ìœ„: class ì†ì„±ì— "language-"ë¡œ ì‹œì‘í•˜ëŠ” ê°’ì„ ê°€ì§„ code ìš”ì†Œ ë‚´ë¶€
   * 
   * ì£¼ì˜ì‚¬í•­: 
   * - data-cloze, data-hint ì†ì„±ì€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ (Ankiê°€ ì²˜ë¦¬)
   * - í™”ë©´ì— ë³´ì´ëŠ” ë‚´ìš©(innerHTML)ë§Œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
   * - ì´ë¯¸ ì´ìŠ¤ì¼€ì´í”„ëœ ë‚´ìš©ì€ ì¤‘ë³µ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
   * - AnkiNoteLinkerëŠ” ë³´í˜¸í•˜ì—¬ ì •ìƒ ë™ì‘í•˜ë„ë¡ í•¨
   * 
   * BACK ì¹´ë“œì—ì„œëŠ” ëª¨ë“  clozeê°€ ì´ë¯¸ í¼ì³ì§„ ìƒíƒœì´ë¯€ë¡œ 
   * ì½”ë“œ ë¸”ë¡ ë‚´ì˜ HTML íƒœê·¸ë“¤ì´ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë˜ì–´ì•¼ í•¨
   */
  function escapeHtmlInCodeBlocks(container) {
    console.log("===== BACK - ì½”ë“œ ë¸”ë¡ ë‚´ AnkiNoteLinker ë³´í˜¸ ì´ìŠ¤ì¼€ì´í”„ ì‹œì‘ =====");
    
    // language-ë¡œ ì‹œì‘í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ëª¨ë“  code ìš”ì†Œ ì°¾ê¸°
    // ì˜ˆ: class="language-js", class="language-python" ë“±
    const codeBlocks = container.querySelectorAll('code[class*="language-"]');
    console.log(`BACK - ì´ ${codeBlocks.length}ê°œì˜ ì½”ë“œ ë¸”ë¡ ë°œê²¬`);
    
    codeBlocks.forEach((codeBlock, blockIndex) => {
      console.log(`\n--- BACK - ì½”ë“œ ë¸”ë¡ #${blockIndex + 1} ì²˜ë¦¬ ---`);
      
      // í•´ë‹¹ ì½”ë“œ ë¸”ë¡ ë‚´ì˜ ëª¨ë“  cloze span ì°¾ê¸°
      const clozeSpans = codeBlock.querySelectorAll('span.cloze');
      console.log(`BACK - ì½”ë“œ ë¸”ë¡ ë‚´ cloze span: ${clozeSpans.length}ê°œ`);
      
      clozeSpans.forEach((span, spanIndex) => {
        console.log(`\n--- BACK - span #${spanIndex + 1} ì²˜ë¦¬ ---`);
        
        /*
         * ì´ë¯¸ ì´ìŠ¤ì¼€ì´í”„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
         * &lt; ë˜ëŠ” &gt;ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì´ë¯¸ ì´ìŠ¤ì¼€ì´í”„ëœ ê²ƒìœ¼ë¡œ íŒë‹¨
         */
        function isAlreadyEscaped(text) {
          return text.includes('&lt;') || text.includes('&gt;');
        }
        
        /*
         * data-clozeì™€ data-hint ì†ì„±ì€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ
         * ì´ìœ : Ankiê°€ ì´ë¯¸ ì ì ˆíˆ ì²˜ë¦¬í•˜ê³  ìˆê³ , 
         *       ì—¬ê¸°ì„œ ìˆ˜ì •í•˜ë©´ ì´ì¤‘ ì´ìŠ¤ì¼€ì´í”„ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥
         * 
         * ì˜¤ì§ í™”ë©´ì— ë³´ì´ëŠ” ë‚´ìš©(innerHTML)ë§Œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
         */
        const originalHtml = span.innerHTML;
        console.log("BACK - ì›ë³¸ HTML:", originalHtml);
        
        // AnkiNoteLinkerê°€ ìˆëŠ”ì§€ í™•ì¸
        const hasAnkiNoteLinker = originalHtml.includes('class="noteLink"') || 
                                  originalHtml.includes('AnkiNoteLinker');
        console.log("BACK - AnkiNoteLinker í¬í•¨?", hasAnkiNoteLinker);
        
        if (!isAlreadyEscaped(originalHtml)) {
          if (hasAnkiNoteLinker) {
            /*
             * AnkiNoteLinkerê°€ ìˆëŠ” ê²½ìš°: AnkiNoteLinkerë§Œ ë³´í˜¸í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì´ìŠ¤ì¼€ì´í”„
             */
            console.log("BACK - AnkiNoteLinker ë³´í˜¸ ëª¨ë“œ");
            
            // AnkiNoteLinker ë§í¬ë¥¼ ì„ì‹œë¡œ ë³´í˜¸
            const protectedLinks = [];
            let protectedContent = originalHtml;
            
            // noteLink í´ë˜ìŠ¤ë¥¼ ê°€ì§„ <a> íƒœê·¸ë¥¼ ì°¾ì•„ì„œ ë³´í˜¸
            protectedContent = protectedContent.replace(/<a[^>]*class="noteLink"[^>]*>.*?<\/a>/gi, function(match) {
              const placeholder = `__CODE_BLOCK_ANKI_LINK_${protectedLinks.length}__`;
              protectedLinks.push(match);
              console.log(`BACK - AnkiNoteLinker ë³´í˜¸ #${protectedLinks.length}:`, match);
              return placeholder;
            });
            
            // ë‚˜ë¨¸ì§€ HTML íƒœê·¸ë“¤ì„ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
            const tempDiv = document.createElement('div');
            tempDiv.textContent = protectedContent;
            protectedContent = tempDiv.innerHTML;
            
            // ë³´í˜¸ëœ AnkiNoteLinker ë³µì›
            protectedLinks.forEach((link, linkIndex) => {
              const placeholder = `__CODE_BLOCK_ANKI_LINK_${linkIndex}__`;
              protectedContent = protectedContent.replace(placeholder, link);
              console.log(`BACK - AnkiNoteLinker ë³µì› #${linkIndex + 1}`);
            });
            
            span.innerHTML = protectedContent;
            console.log("BACK - AnkiNoteLinker ë³´í˜¸ ì²˜ë¦¬ ì™„ë£Œ:", protectedContent);
            
          } else {
            /*
             * AnkiNoteLinkerê°€ ì—†ëŠ” ê²½ìš°: ì¼ë°˜ì ì¸ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
             */
            // textContentë¡œ ì„¤ì •í•˜ë©´ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ HTMLì„ ì´ìŠ¤ì¼€ì´í”„í•¨
            // ì˜ˆ: <li></li> â†’ &lt;li&gt;&lt;/li&gt;
            span.textContent = originalHtml;
            console.log("BACK - ì¼ë°˜ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì™„ë£Œ:", span.innerHTML);
          }
        } else {
          console.log("BACK - ì´ë¯¸ ì´ìŠ¤ì¼€ì´í”„ëœ ë‚´ìš©, ê±´ë„ˆë›°ê¸°");
        }
      });
    });
    
    console.log("===== BACK - ì½”ë“œ ë¸”ë¡ ë‚´ AnkiNoteLinker ë³´í˜¸ ì´ìŠ¤ì¼€ì´í”„ ì™„ë£Œ =====");
  }

  function replaceInString(str) {
    str = str.replace(/<[\/]?pre[^>]*>/gi, "");
    str = str.replace(/<br\s*[\/]?[^>]*>/gi, "\n");
    str = str.replace(/<div[^>]*>/gi, "\n");
    // Thanks Graham A!
    // str = str.replace(/<[\/]?span[^>]*>/gi, "")
    str.replace(/<\/div[^>]*>/g, "\n");
    return replaceHTMLElementsInString(str);
  }

  function replaceHTMLElementsInString(str) {
    str = str.replace(/&nbsp;/gi, " ");
    str = str.replace(/&tab;/gi, "	");
    str = str.replace(/&gt;/gi, ">");
    str = str.replace(/&lt;/gi, "<");
    return str.replace(/&amp;/gi, "&");
  }
</script>

<script>
    // Anki Note Linkerë¥¼ Mobile í™˜ê²½ì—ì„œë„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ fallback ì½”ë“œ
    var disableLinks = false; // Change to true if you want to disable all link rendering for clients without add-on
    if (!window.AnkiNoteLinkerIsActive) {
        const renderLinks = _ => {
            document.querySelectorAll('.linkRender').forEach(element => { // You can rename "linkRender" on this line, but leave the "." in front
                element.innerHTML = element.innerHTML.replace(
                    /\[((?:[^\[]|\\\[)*)\|nid(\d{13})\]/g,
                    (match, title, nid) => {
                        title = title.replace(/\\\[/g, '[');
                        let link;
                        if (document.documentElement.classList.contains('iphone') || document.documentElement.classList.contains('ipad')) {
                            link = `anki://x-callback-url/search?query=nid%3a${nid}`;
                        } else try {
                            window.jsAPI ||= new AnkiDroidJS({ version: "0.0.3", developer: "github.com/gugutu" });
                            link = `javascript:window.jsAPI.ankiSearchCard(\`nid:${nid}\`)`;
                        } catch (e) {
                            link = `https://ankiuser.net/edit/${nid}' target='_blank`;
                        }
                        return disableLinks ? `${title}` : `<a href='${link}' class='noteLink'>${title}</a>`;
                    }
                );
            });
        };
        document.readyState !== 'loading' ? renderLinks() : document.addEventListener('DOMContentLoaded', renderLinks, { once: true });
    }
</script>

<!-- 
ğŸ¯ ANKI CLOZE + MARKDOWN + ì½”ë“œ ë¸”ë¡ ì²˜ë¦¬ í”Œë¡œìš° ìƒì„¸ ì„¤ëª… (BACK ì¹´ë“œ - AnkiNoteLinker ì§€ì›)

=== ğŸ“‹ ì „ì²´ ê°œìš” ===
ì´ BACK ì¹´ë“œ í…œí”Œë¦¿ì€ front.htmlê³¼ ë™ì¼í•œ ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ ë¡œì§ì„ ì‚¬ìš©í•˜ë˜,
ëª¨ë“  clozeê°€ ì´ë¯¸ í¼ì³ì§„ ìƒíƒœë¡œ í‘œì‹œë˜ë¯€ë¡œ í´ë¦­/í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬ëŠ” ì—†ìŠµë‹ˆë‹¤.
â˜… AnkiNoteLinker ì§€ì›: ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì—ì„œë„ AnkiNoteLinkerê°€ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤.

=== ğŸ”„ ì£¼ìš” ì²˜ë¦¬ í”Œë¡œìš° ===

1ï¸âƒ£ ì´ˆê¸°í™” (render í•¨ìˆ˜)
   â”œâ”€ renderLinksBeforeEscape() : AnkiNoteLinker ì‚¬ì „ íŒŒì‹± â˜… ìƒˆë¡œ ì¶”ê°€ â˜…
   â”œâ”€ renderMath("back") : KaTeX ìˆ˜í•™ ê³µì‹ ë Œë”ë§ (back ì˜ì—­)
   â”œâ”€ markdown("back") : ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ (í•µì‹¬ ë¡œì§)
   â”œâ”€ renderMath("extra") : KaTeX ìˆ˜í•™ ê³µì‹ ë Œë”ë§ (extra ì˜ì—­)
   â”œâ”€ markdown("extra") : ë§ˆí¬ë‹¤ìš´ + cloze ì²˜ë¦¬ (extra ì˜ì—­)
   â”œâ”€ show() : ì¹´ë“œ í‘œì‹œ
   â””â”€ cloze ìŠ¤íƒ€ì¼ë§ : ì´ë¯¸ í¼ì³ì§„ clozeì˜ ì‹œê°ì  ìŠ¤íƒ€ì¼ ì ìš©

2ï¸âƒ£ ë§ˆí¬ë‹¤ìš´ ì²˜ë¦¬ (markdown í•¨ìˆ˜) â˜… front.htmlê³¼ ë™ì¼ â˜…
   â”œâ”€ STEP 0: ë§ˆí¬ë‹¤ìš´ íŒŒì‹± ì´ì „ ë°±í‹± ì½”ë“œ ì „ì²˜ë¦¬ â˜… front.htmlê³¼ ë™ì¼ â˜…
   â”‚   â”œâ”€ [PROTECTED_CODE_n] í˜•íƒœë¡œ Anki í•„ë“œ ë¬¸ë²•ê³¼ markdown-itì˜ ë³¼ë“œ í•´ì„ ëª¨ë‘ ë°©ì§€
   â”‚   â”œâ”€ ì½”ë“œ ë¸”ë¡(```...```) ë‚´ë¶€ëŠ” ì œì™¸í•˜ì—¬ ê¸°ì¡´ íŒŒì‹± ë¡œì§ ë³´í˜¸
   â”‚   â””â”€ í…Œì´ë¸” ë° ì¼ë°˜ ì˜ì—­ì˜ ë°±í‹±ë§Œ ë³´í˜¸í•˜ì—¬ ë§ˆí¬ë‹¤ìš´ íŒŒì‹± ì‹œ êµ¬ì¡° ê¹¨ì§ ë°©ì§€
   â”‚
   â”œâ”€ STEP 1: ì½”ë“œ ë¸”ë¡ ë‚´ cloze span ì„ì‹œ ì €ì¥
   â”‚   â”œâ”€ ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ íŒ¨í„´ íƒì§€ : /(```[a-zA-Z0-9_\-]+[\s\S]*?```)/g
   â”‚   â”œâ”€ ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì˜ <span class="cloze">...</span> ì¶”ì¶œ
   â”‚   â””â”€ í”Œë ˆì´ìŠ¤í™€ë”(__CLOZE_SPAN_X__)ë¡œ ì„ì‹œ êµì²´
   â”‚
   â”œâ”€ STEP 2: ë§ˆí¬ë‹¤ìš´ ë³€í™˜ ìˆ˜í–‰
   â”‚   â””â”€ markdown-it ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë§ˆí¬ë‹¤ìš´ â†’ HTML ë³€í™˜
   â”‚
   â”œâ”€ STEP 3: ì¼ë°˜ span íƒœê·¸ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
   â”‚   â””â”€ &lt;/span&gt; â†’ \ êµì²´
   â”‚
   â”œâ”€ STEP 4: ì €ì¥ëœ cloze span ë³µì›
   â”‚   â””â”€ í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì›ë˜ cloze spanìœ¼ë¡œ êµì²´ (ì´ìŠ¤ì¼€ì´í”„ ì—†ì´)
   â”‚
   â”œâ”€ STEP 5: DOMì— ì„¤ì •
   â”‚   â””â”€ element.innerHTML = finalText
   â”‚
   â”œâ”€ STEP 5.5: ë°±í‹± ì½”ë“œ ë³µì› â˜… front.htmlê³¼ ë™ì¼ â˜…
   â”‚   â””â”€ ì „ì²˜ë¦¬ë¡œ ë³´í˜¸ëœ ëª¨ë“  ë°±í‹±ì„ ì•ˆì „í•˜ê²Œ ë³µì›
   â”‚
   â”œâ”€ STEP 6: ì´ˆê¸° ë°±í‹± â†’ ì½”ë“œ íƒœê·¸ ë³€í™˜ (ëª¨ë“  clozeì— ì ìš©)
   â”‚   â””â”€ convertBackticksToCodeTags() í˜¸ì¶œ
   â”‚
   â”œâ”€ STEP 7: ë‹¨ìˆœí•œ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ (AnkiNoteLinker ë³´í˜¸)
   â”‚   â””â”€ escapeSpecificHtmlTags() í˜¸ì¶œ
   â”‚
   â””â”€ STEP 8: ì½”ë“œ ë¸”ë¡ ë‚´ HTML ì´ìŠ¤ì¼€ì´í”„ (AnkiNoteLinker ë³´í˜¸)
       â””â”€ escapeHtmlInCodeBlocks() í˜¸ì¶œ

3ï¸âƒ£ AnkiNoteLinker ì‚¬ì „ íŒŒì‹± (renderLinksBeforeEscape í•¨ìˆ˜) â˜… ìƒˆë¡œ ì¶”ê°€ â˜…
   â”œâ”€ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì „ì— AnkiNoteLinker íŒ¨í„´ íŒŒì‹±
   â”œâ”€ [ì œëª©|nidXXXXXXXXXXXXX] â†’ <a href="..." class="noteLink">ì œëª©</a> ë³€í™˜
   â””â”€ ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ì—ì„œë„ AnkiNoteLinkerê°€ ì •ìƒ ë™ì‘ ë³´ì¥

4ï¸âƒ£ ì½”ë“œ ë¸”ë¡ HTML ì´ìŠ¤ì¼€ì´í”„ (escapeHtmlInCodeBlocks í•¨ìˆ˜) â˜… AnkiNoteLinker ë³´í˜¸ ê°•í™” â˜…
   â”œâ”€ code[class*="language-"] ìš”ì†Œë“¤ íƒìƒ‰
   â”œâ”€ ê° ì½”ë“œ ë¸”ë¡ ë‚´ì˜ span.cloze ìš”ì†Œë“¤ ì°¾ê¸°
   â”œâ”€ AnkiNoteLinker ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (class="noteLink" ê²€ì‚¬)
   â”œâ”€ AnkiNoteLinkerê°€ ìˆëŠ” ê²½ìš°: ë§í¬ë§Œ ë³´í˜¸í•˜ê³  ë‚˜ë¨¸ì§€ HTML ì´ìŠ¤ì¼€ì´í”„
   â””â”€ AnkiNoteLinkerê°€ ì—†ëŠ” ê²½ìš°: ì¼ë°˜ì ì¸ HTML ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬

=== ğŸ¯ BACK ì¹´ë“œ íŠ¹ì§• ===

âœ… ëª¨ë“  clozeê°€ í¼ì³ì§„ ìƒíƒœ: Ankiì—ì„œ ìë™ìœ¼ë¡œ ëª¨ë“  cloze ë‚´ìš©ì´ í‘œì‹œë¨
âœ… ì½”ë“œ ë¸”ë¡ ë‚´ HTML ì´ìŠ¤ì¼€ì´í”„: frontì™€ ë™ì¼í•˜ê²Œ HTML íƒœê·¸ê°€ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œë¨
âœ… ë§ˆí¬ë‹¤ìš´ íŒŒì‹±: ì¼ë°˜ ì˜ì—­ì˜ ë§ˆí¬ë‹¤ìš´ì€ ì •ìƒì ìœ¼ë¡œ ë Œë”ë§ë¨
âŒ ìƒí˜¸ì‘ìš© ì—†ìŒ: í´ë¦­/í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¶ˆí•„ìš”

=== ğŸ” ì²˜ë¦¬ ì˜ˆì‹œ ===

ğŸ“ ì¼ë°˜ ì˜ì—­ cloze:
   ì…ë ¥: **bold text** in cloze
   ì¶œë ¥: <b>bold text</b> in cloze (ë§ˆí¬ë‹¤ìš´ íŒŒì‹±ë¨)

ğŸ’» ì½”ë“œ ë¸”ë¡ ë‚´ cloze (ì¼ë°˜ HTML):
   ì…ë ¥: <li>list item</li>
   ì¶œë ¥: &lt;li&gt;list item&lt;/li&gt; (HTML íƒœê·¸ê°€ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ)

ğŸ”— ì½”ë“œ ë¸”ë¡ ë‚´ cloze (AnkiNoteLinker):
   ì…ë ¥: [ìœ íš¨|nid1749360987838]
   ì¶œë ¥: <a href="..." class="noteLink">ìœ íš¨</a> (í´ë¦­ ê°€ëŠ¥í•œ ë§í¬)

=== ğŸ“š ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ ===
- KaTeX: ìˆ˜í•™ ê³µì‹ ë Œë”ë§
- highlight.js: ì½”ë“œ êµ¬ë¬¸ ê°•ì¡°  
- markdown-it: ë§ˆí¬ë‹¤ìš´ íŒŒì‹±
- markdown-it-mark: ==í…ìŠ¤íŠ¸== ë§ˆí¬ ì§€ì›
- markdown-it-container: ì»¤ìŠ¤í…€ ì»¨í…Œì´ë„ˆ ì§€ì› (tip, warning ë“±)

 -->